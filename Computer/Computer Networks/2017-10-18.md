## 2017-10-18

- __Round-trip time (RTT)__: the time it takes for a small packet to travel from client to server and then back to the client.
- TCP __three-way handshake__ (2 RTTS):
    - The client sends a small TCP segment to the server.
    - The server acknowledges and responds with a small TCP segment.
    - The client acknowledges back to the server.
- HTTP/TCP connections:
    - _Three-way handshake_ via a TCP connection between the HTTP client and the HTTP server on port number 80.
    - The HTTP client sends an HTTP request message to the server via its socket.
    - The HTTP server process receives the request message via its socket, retrieves the object, encapsulates the object in an HTTP response message, and sends the response message to the client via its socket.
    - The HTTP server process tells TCP to close the TCP connection.
    - The HTTP client receives the response message. The TCP connection terminates.
    - HTTP request: request line + header lines + blank line (CRLF) + entity body.
    - HTTP response: status line + header lines + blank line (CRLF) + entity body.
- HTTP request methods (in method field of request line):
    - __GET__: input is uploaded in URL field of request line.
    - __POST__: input is uploaded in entity body.
    - __HEAD__: asks server to leave requested object out of response.
- __Non-persistent__ v.s. __persistent__ HTTP/TCP connections:
    - __Non-persistent__: each request/response pair be sent over a separate TCP connection.
    - __Persistent__: all of the requests/responses be sent over the same TCP connection.
- Response time of HTTP/TCP connections: 2 RTTs + transmission time.
- __Cookies__:
    - Four components: (1) a cookie header line in the HTTP response message; (2) a cookie header line in the HTTP request message; (3) a cookie file kept on the user's end system and managed by the user's browser; and (4) a back-end database at the website.
    - Cookies can bring authorization, user session state, etc.
- __Web cache__ (or __proxy server__):
    - A network entity that satisfies HTTP requests on the behalf of an origin Web server.
    - Acts as both client and server.
    - Typically cache is installed by ISP.
    - Reduces (1) the response time for a client request, (2) traffic on an institution's access link to the Internet, and (3) Web traffic in the Internet as a whole.
    - Total average delay = __internet delay__ (the amount of time it takes from when the router on the Internet side of the access link until it receives the response) + __access delay__ (dependent on utilization on access link, varied) + __LAN delay__ (dependent on utilization on LAN, negligible).
- __Conditional GET__: 
    - The request message using the GET method and including an __If-Modified-Since__ in header line.
    - Suppose the object has not been modified, the Web server sends a response message to the cache with the status code: __304 Not Modified__.
- FTP/TCP connections:
    - Two parallel TCP connections: a __control connection__ and a __data connection__.
    - FTP client contacts FTP server on port number 21 (__control connection__).
    - On receiving a command for a file transfer, the server side initiates a TCP data connection to the client side on port number 20 (__data connection__).
    - FTP sends exactly one file over the data connection and then closes the _data connection_.
    - Throughout a session, the FTP server must maintain __state__ about the user.
- __In-band__ v.s. __out-of-band__:
    - __In-band__: control commands sent in the same connection that transfers data, e.g. HTTP, SMTP, etc.
    - __Out-of-band__: control commands sent via a different connection from the one that transfers data, e.g. FTP.
- Three major components of electronic mails:
    - User agents and mail servers.
    - __Mail transfer protocol__: between two mail servers, and sending messages from a user agent to a mail server, e.g. SMTP.
    - __Mail access protocol__: accessing messages by a user agent from a mail server, e.g. HTTP, __Post Office Protocol (POP)__, __Internet Mail Access Protocol (IMAP)__, etc.
- SMTP/TCP connections:
    - Transfers messages from senders' mail servers to the recipients' mail servers.
    - _Handshake_ via a TCP connection between the SMTP client and the SMTP server on port number 25.
    - SMTP request: commands (HELO, MAIL FROM, RCPT TO, DATA, and QUIT).
    - SMTP response: status line.
    - __Mail message__ (following DATA command): header lines + message body.
    - Each mail message ends with a line consisting of a single period (__CRLF.CRLF__).
    - SMTP uses persistent connections.
- __Pull__ v.s. __Push__ protocol:
    - __Pull__: the client pulls the data from the server, e.g. HTTP, POP3, IMAP, etc.
    - __Push__: the client pushes the data to the receiving server, e.g. SMTP. 
- POP3 v.s IMAP:
    - POP3 downloads and keeps messages on different clients machine, while IMAP keeps all messages in one place: the server.
    - POP3 protocol does not provide any means for a user to create remote folders and assign messages to folders, while IMAP does.
    - POP3 is stateless across sessions, while IMAP keeps user state across sessions.